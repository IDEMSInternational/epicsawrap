% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/update_crop_definitions.R
\name{update_crops_definitions}
\alias{update_crops_definitions}
\title{Update crops definitions from stored configuration}
\usage{
update_crops_definitions(
  data_frame,
  data_names,
  seasonal_data_frame,
  seasonal_data_names,
  definitions,
  data_book
)
}
\arguments{
\item{data_frame}{A data frame (or name) containing daily data.}

\item{data_names}{A list with element names for daily data:
\code{date}, \code{year}, \code{station}, \code{doy}, \code{rain}.}

\item{seasonal_data_frame}{A data frame (or name) containing seasonal windows.}

\item{seasonal_data_names}{A list with element names for seasonal data:
\code{start_day}, \code{end_day}.}

\item{definitions}{A list with (optional) elements
\code{$crops_success} and \code{$season_start_probabilities}. Each may
contain entries such as \code{s_start_month}, \code{start_check},
\code{return_crops_table}, and grid definitions under keys like
\code{water_requirements}, \code{planting_dates}, \code{planting_length},
or \code{specified_day}. Grids may be vectors or lists with
\code{from}/\code{to}/\code{by}.}

\item{data_book}{The data book object forwarded to
\code{rpicsa::crops_definitions()}.}
}
\value{
\itemize{
\item A single object returned by \code{rpicsa::crops_definitions()} if only one
definition block is active or both blocks match.
\item A list with elements \code{$crop_success} and
\code{$season_start_probabilities} if both blocks exist and differ.
}
}
\description{
Reads the \emph{crop success} and (optionally) \emph{season start probabilities}
definition blocks and produces crops definition tables via
\code{rpicsa::crops_definitions()}.
}
\details{
If only one block is present, returns a single table based on that block.
If both blocks are present and their parameter grids match (same
\code{rain_totals}, \code{plant_days}, \code{plant_lengths}), a single
table is returned with \code{definition_props = TRUE}. If both exist but
differ, both tables are generated and returned in a list.

This function converts stored month dates in \code{s_start_month} to a
numeric month (\code{1â€“12}) via \code{as.Date(..., origin = "2020-12-31")}
to avoid leap year ambiguity. Logical-like flags (\code{start_check},
\code{return_crops_table}, \code{definition_props}) are expected to be
provided upstream (e.g., as \code{TRUE}/\code{FALSE} or strings that a
project helper such as \code{as_logical()} converts).
}
\examples{
\dontrun{
defs <- list(
  crops_success = list(
    s_start_month =  "2021-01-01",
    start_check = TRUE,
    return_crops_table = TRUE,
    water_requirements = list(from = 100, to = 200, by = 25),
    planting_dates     = c(150, 165, 180),
    planting_length    = c(60, 75, 90)
  )
)
update_crops_definitions(daily_df, list(date="date", year="year", station="id",
                         doy="doy", rain="rain"),
                         seasonal_df, list(start_day="s_day", end_day="e_day"),
                         defs, data_book)
}
}